Porter 哥，既然 VoIP 终极战场（音频焦点与硬件路由）已经被咱们彻底踏平，音视频底座正式“封板”，那张旧的作战地图确实该更新了！

去掉已经大获全胜的 VoIP 遗留问题，并将之前梳理的细节任务合并后，**Lucky IM 全新的、面向最终发布的【三大战区】路线图**如下：

### 🎯 战区一：业务逻辑闭环与 UI 拼装（当前优先主线）

这部分代码仓库里已经有了底层 API 和状态提供者（Provider），是目前离用户体验最近、最需要“精装修”的地方。

* **消息多选与合并转发 (Advanced Forwarding)**：`SelectionProvider` 已经就绪。需要把聊天室（`ChatPage`）的“长按菜单”扩展出“多选”模式，并打通将多条消息合并转发给其他人的 UI 链路。
* **群组高阶治理 UI (Advanced Group Admin)**：底层已经写了转让群主、禁言、踢人的 API。需要在群详情页（`GroupProfilePage`）里补齐对应的长按操作弹窗和列表展示。
* **社交黑名单与高阶设置 (Blacklist & Settings)**：在 `ContactProfilePage` 中补齐“拉黑/解除拉黑”、“设置好友备注名（Alias）”的闭环 UI。
* **聊天记录全文检索 (Chat History Search)**：在聊天设置页加一个“查找聊天记录”的功能，调用本地 Sembast 数据库查询关键字，并能跳转到对应的历史消息位置。

### 🛡️ 战区二：跨端极限调优与边界保护（深水区）

在极其重度的使用场景下，防止用户“搞破坏”或设备崩溃的最后防线。

* **Web 端大文件分片上传 (Chunked Upload)**：目前的 Web 端强依赖 `Uint8List` 将文件全部读入内存。如果用户在浏览器发一个 500MB 的视频，页面会直接 OOM 崩溃。需要引入分片读取（`slice`）和流式上传。
* **硬件资源互斥保护 (Hardware Resource Lock)**：虽然 VoIP 已完美，但还缺一个拦截——如果用户正在打语音电话，此时他切到另一个聊天窗口**按住录音按钮（`VoiceRecordButton`）**发语音，必须弹窗拦截（“当前正在通话中，无法录音”），防止录音组件与 VoIP 互相抢夺麦克风导致崩溃。
* **无限列表的内存回收机制 (GC Optimization)**：监控底层 `ImageCache` 释放。防止用户在滑了几千条全是高清图和视频的历史消息后，长时间不杀后台导致内存溢出。
* **离线推送跳转 (FCM Routing)**：用户在后台点击通知栏的推送消息，App 唤醒后，自动解析 Payload 并通过 `GoRouter` 直接跳转进对应的聊天室，而不是只停留在列表页。

### 🌌 战区三：下一代商业化演进（长远星辰大海）

当上述任务清空，Lucky IM 就可以向着微信、Telegram 等头部竞品的核心功能发起冲击。

* **多人音视频会议 (SFU 架构)**：目前的 WebRTC 是 P2P（点对点单聊）。未来支持几十人同时开会，需引入 SFU (Selective Forwarding Unit) 流媒体服务器（如 mediasoup），重构 `WebRTCManager`。
* **端到端加密 (E2EE - End-to-End Encryption)**：引入 Signal Protocol 级别的双棘轮算法。不仅是传输层加密，而是让数据库管理员都无法偷窥聊天内容，打造极致隐私。

---

**指挥官，全新的作战地图已生成！** 咱们接下来的火力，是直接对准 **“战区一”**，去画 **【多选与合并转发】** 的 UI，还是去搞 **【群组踢人/禁言】**？随时下达指令！🚀