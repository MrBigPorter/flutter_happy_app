基于我们刚刚完成的 v6.1.0 封档日志，你的执行力非常强，**Level 1 (信令)** 和 **Level 3 (UI交互)** 已经彻底拿下，**Level 2 (P2P)** 和 **Level 4 (OS集成)** 的核心代码逻辑也已经跑通。

如果我们把“已经做完”的剥离掉，**剩下的硬骨头**（也是从 Demo 走向商业产品的差距）主要集中在**基础设施**和**原生深度集成**上。

以下是为你更新后的 **剩余挑战清单**：

---

### 🧱 Level 2: 基础设施升级 (Infrastructure) —— **【剩余 50%】**

**状态**：代码逻辑已通 (STUN)，但缺少“大杀器” (TURN)。


* **🔴 待攻克**：
* **部署 Coturn (TURN 服务器)**：这是解决“内网能通，4G不通”的唯一解。你需要购买一台云服务器，搭建 Coturn，并在 `call_controller.dart` 里配置账号密码。没有这个，你的 App 只能在 WiFi 下自嗨。



---

### 🔥 Level 4: 深度系统集成 (Native Call UI) —— **【剩余 60%】**

**状态**：实现了“应用保活”，但还没实现“系统级来电”。

* **已完成**：
* [x] **iOS Background Audio/VoIP**：勾选了 Xcode 配置，保证了 App 在后台/锁屏时 **通话不断线**。
* [x] **Android Foreground Service**：实现了安卓前台服务保活。


* **🔴 待攻克**：
* **iOS CallKit / Android ConnectionService**：
* 目前：你的来电是一个 App 内的弹窗/页面。如果 App 被杀了，或者锁屏很久了，你可能收不到。
* 目标：接入 CallKit，让来电显示像**系统自带电话**一样（全屏、滑动接听），并且能通过 VoIP Push (PushKit) 在 App 被杀死的情况下**唤醒设备**。





---

### ☠️ Level 5: 稳定性与边界 (The Edge Cases) —— **【剩余 100%】**

**状态**：目前未触及，是未来优化的深水区。

* **🔴 待攻克**：
* **网络切换 (Handover)**：通话中从 WiFi 切到 4G，目前的 Socket 可能会断，WebRTC 连接可能会崩。需要实现检测到网络变更时触发 `ICE Restart`。
* **音频路由管理**：处理蓝牙耳机插拔、扬声器/听筒自动切换的复杂逻辑（比如 iOS 上拔掉耳机后，声音该走哪？）。
* **通话打断**：你正在视频，突然 10086 打电话进来了，你的 App 应该自动静音还是自动挂起？



---

### 💡 下一步行动建议

既然“代码逻辑”已经写完了，接下来的工作重心应该转移到 **“服务器”** 和 **“原生体验”** 上。

建议的优先级：

1. **最高 (Must-Have)**：**搭建 TURN 服务器**。这一步不做，这个功能就没法真正发布给朋友用。
2. **次高 (Should-Have)**：**iOS CallKit 集成**。这能极大地提升逼格和接通率。
3. **最后 (Nice-to-Have)**：边缘情况处理。等用户反馈有问题再修。

