
### ☠️ Level 5: 稳定性与边界 (The Edge Cases) —— **【最终战场】**

**现状**：现在你的 App 已经能在锁屏下被原生唤醒，且画面互通。但在现实生活中极端的物理环境突变下，还需要最后的打磨才能做到“坚不可摧”。

* **🔴 核心挑战 C：网络无缝切换与重连 (ICE Restart)**
* **难度**：⭐⭐⭐⭐
* **场景**：用户正在和你视频，他拿着手机走出了家门。手机网络瞬间从 WiFi 切换到了 4G/5G。
* **后果**：用户的底层 IP 地址变了，原有的 WebRTC P2P/Relay 通道会瞬间断裂，画面卡死。
* **解法**：需要监听网络状态的突变 -> 触发 Socket 极速重连 -> 执行 WebRTC 标准的 `restartIce()` 流程 -> 重新交换一次 SDP -> 画面在卡顿 1-2 秒后瞬间恢复。


* **🔴 核心挑战 D：音频焦点与硬件路由管理 (Audio Focus & Routing)**
* **难度**：⭐⭐⭐
* **场景 1（被原生打断）**：你正在用 Lucky IM 视频，突然 10086（系统普通电话）打进来了。系统原生电话拥有最高特权，它会瞬间抢夺麦克风和音频焦点。我们要处理好“被动静音”和“电话挂断后的恢复”。
* **场景 2（外设插拔）**：用户在通话中途，突然戴上了 AirPods 蓝牙耳机，或者插上了有线耳机。目前简单的 `toggleSpeaker` 可能无法自动且无缝地把声音转移到蓝牙设备里。



