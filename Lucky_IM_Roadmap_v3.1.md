
# 🚦 Lucky IM Roadmap (Next Steps)

> **🚀 当前阶段**：v3.5 Final Polish (最后视觉打磨)
> **🎯 核心目标**：攻克群头像合成算法，彻底结束 v3.5，随即启动 v3.6 多媒体扩展。

---

## 1. 🎨 v3.5 视觉收尾 (Visual Finalization)

### 🚧 [P1] 群聊头像合成 (Group Avatar)

> **现状**：群聊功能完美，但列表展示的头像还是默认图或单张图，不够专业，像“草台班子”。

* [ ] **九宫格合成算法**:
* **逻辑**: 取群成员前 9 人（或 4 人）头像。
* **绘制**: 使用 `Canvas` 或 `ImageEditor` 将它们拼合成一张正方形图片（类似微信/钉钉）。
* **缓存**: 这是一个耗时操作，合成后的图片必须缓存到本地（AssetManager），群成员变更时才重新生成。



---

## 2. 🎬 v3.6 媒体扩展 (Rich Media Expansion)

> **目标**：引入流媒体处理能力，让 IM “动”起来。

### [P3] 视频消息 (Video Message)

* [ ] **架构扩展**: `AssetManager` 适配 `.mp4` / `.mov`。
* [ ] **发送流程**: 视频选取 -> **获取首帧缩略图** -> 视频压缩 -> 上传（封面+视频）。
* [ ] **播放体验**:
* 聊天气泡：显示封面 + 播放按钮。
* 全屏播放：点击跳转视频播放器（支持进度条/暂停）。



### [P4] 文件消息 (File Message)

* [ ] **通用文件**: 支持 PDF, DOC, ZIP 等图标渲染。
* [ ] **下载管理**: 实现下载进度条，调用系统 `Open With` 打开文件。

---

## 3. 🔮 v4.0 远期展望 (Advanced Features)

* [ ] **[P5] 音视频通话 (WebRTC)**: 1v1 及多人实时通话。
* [ ] **[P6] 全局搜索 (FTS)**: 本地数据库全文检索。
* [ ] **[P7] 端到端加密 (E2EE)**: Signal Protocol 集成。

---

## 📝 指挥官指令 (Action Plan)

战场清理完毕，目标只剩下一个：

👉 **建议下一步**：
**一鼓作气，拿下 [P1] 群聊头像合成**。

**理由**：

1. **视觉统一**：现在群功能逻辑是满分的，但“面子”（头像）还没跟上。把它做完，你的 v3.5 就是真正的“像素级完美”。
2. **难度适中**：这是一个纯前端的图形处理任务，不涉及后端 API，适合在攻坚视频功能前做一个有趣的过渡。

**准备好了吗？我们是先搞定这个头像，还是直接跳过它去搞视频？** 😎